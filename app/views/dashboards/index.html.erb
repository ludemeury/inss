<%= provide :title, "Dashboard Proponentes" %>

<div class="container mt-4">
  <h1>Quantidade de funcion√°rios por faixa salarial</h1>

  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th>Faixa Salarial</th>
        <th>Quantidade</th>
        <th>Atualizado em</th>
      </tr>
    </thead>
    <tbody>
      <% @proponent_reports.each do |report| %>
        <tr>
          <td><%= report.indicator %></td>
          <td><%= report.amount.to_i %></td>
          <td><%= report.updated_at.strftime('%B %d, %Y') %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <div class="mt-5">
    <canvas id="reportChart" width="400" height="200"></canvas>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const indicators = <%= raw @proponent_reports.map { |report| "'#{report.indicator}'" }.to_json %>;
      const amounts = <%= raw @proponent_reports.map { |report| report.amount.to_f }.to_json %>;

      const ctx = document.getElementById('reportChart').getContext('2d');

      const chart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: indicators,
          datasets: [{
            label: 'Quantidade',
            data: amounts,
            backgroundColor: 'rgba(54, 162, 235, 0.2)',
            borderColor: 'rgba(54, 162, 235, 1)',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    });
  </script>
</div>
